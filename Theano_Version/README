Thie is an older version using theano. The code is not tested. 
